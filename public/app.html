<link rel="import" href="components/polymer/polymer.html">
<link rel="import" href="components/polymerfire/firebase-auth.html">
<link rel="import" href="components/polymerfire/firebase-app.html">
<link rel="import" href="components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="components/iron-icons/iron-icons.html">
<link rel="import" href="auth-fragment.html">
<link rel="import" href="shared-styles.html">



<dom-module id="my-app">
    <template>
        <style>
            :host {
                display: block;                
            }                        
        </style>        
        <div>
            <firebase-app 
                auth-domain="sweltering-fire-9513.firebaseapp.com"
                database-url="https://sweltering-fire-9513.firebaseio.com/"
                api-key="AIzaSyAidlyZ3BhSU1JRIgILqDFcSWGB6RBGZ5E">
            </firebase-app>

            <firebase-auth 
                id="auth" 
                user="{{user}}" 
                status-known="{{statusKnown}}"
                provider="google" 
                on-error="handleError">
            </firebase-auth>                       
            
            <paper-icon-button on-tap="signout" icon="icons:power-settings-new"></paper-icon-button>
                        
            <auth-fragment
                user="{{user}}"
                prompt-sign-in="{{promptSignIn}}"
                auth="{{auth}}"
                ></auth-fragment>                              
        </div>
    </template>
    <script>
        Polymer({
            is: 'my-app',
            properties: {
                user: {
                    type: Object
                },
                statusKnown:{
                    type: Boolean             
                },
                promptSignIn: {
                    type: Boolean,
                    computed: '_computePrompt(user, statusKnown)'
                },
                auth: {
                    type: Object
                }
            },            
            ready(){
                this.auth = this.$.auth;
            },
            _computePrompt(user, statusKnown){
                return !user && statusKnown;
            },                                    
            signout(){
                this.$.auth.signOut()
                    .then((response) => {})
                    .catch((error) => {});
            },
            handleError(){

            }
        });
    </script>
</dom-module>
