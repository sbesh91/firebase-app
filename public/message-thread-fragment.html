<link rel="import" href="components/polymer/polymer.html">
<link rel="import" href="reply-fragment.html">
<link rel="import" href="comment-vote-fragment.html">
<link rel="import" href="shared-styles.html">

<dom-module id="message-thread-fragment">
    <template>
        <style include="shared-styles"></style>
        <style>
            :host {
                display: block;
                margin:8px 0 8px 10px;                                
            }

            .comment{
                display: flex;
                margin: 2px 0;
                padding:3px 5px 5px 5px ;
                border-top-left-radius: 2px;
                border-bottom-left-radius: 2px;
                transition: box-shadow 200ms cubic-bezier(0.075, 0.82, 0.165, 1);                
            }           
            .comment:nth-of-type(2n){
                background: var(--zebra-even);
            }
            .comment:nth-of-type(2n + 1){
                background: var(--zebra-odd);
            }
            .comment:hover{
                box-shadow: var(--shadow);
            }
            .comment.active{
                box-shadow: var(--shadow);
            }
            .body{
                flex: 1 1 auto;
            }
            .username{
                font-size: 13px;
            }
            a{
                color:var(--text-light-color);
            }
        </style>
        
                    
        
        <template 
            is="dom-repeat" 
            items={{comments}} 
            as=comment>
            <!--maybe reorganize into a component to hold state-->
            <div class="comment">
                <comment-vote-fragment
                    comment="{{comment}}"
                    user="[[user]]">                    
                </comment-vote-fragment>
                <div class="body">
                    <a class="username" href="/#/users/{{comment.uid}}">[[comment.username]]</a>
                    <div class="text">[[comment.text]]</div>                
                     <reply-fragment 
                        user="[[user]]"
                        comments="{{comment.comments}}">                
                    </reply-fragment>
                </div>                                
            </div>                                    

            <template is="dom-if" if={{comment.comments}}>
                <message-thread-fragment 
                    user="[[user]]"
                    comments="{{comment.comments}}">
                </message-thread-fragment>      
            </template>                                      
        </template>                  
    </template>
    <script>
        Polymer({
            is: 'message-thread-fragment',
            properties: {
                comments: {
                    type: Array,
                    notify: true
                },                
                user:{
                    type: Object
                },                
                postPath:{
                    type: String
                },                
            },                                    
        });
    </script>
</dom-module>